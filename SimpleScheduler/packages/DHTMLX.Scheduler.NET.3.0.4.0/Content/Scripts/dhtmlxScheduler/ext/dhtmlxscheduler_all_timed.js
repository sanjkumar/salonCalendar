/*
Copyright Dinamenta, UAB. http://www.dhtmlx.com
To use this component please contact sales@dhtmlx.com to obtain license
*/
Scheduler.plugin(function(a){(function(){a.config.all_timed="short";var m=function(a){return!((a.end_date-a.start_date)/36E5>=24)},n=a._pre_render_events_line;a._pre_render_events_line=function(b,g){function h(a){var b=j(a.start_date);return+a.end_date>+b}function j(b){var c=a.date.add(b,1,"day");return c=a.date.date_part(c)}function k(b,c){var d=a.date.date_part(new Date(b));d.setHours(c);return d}if(!this.config.all_timed)return n.call(this,b,g);for(var e=0;e<b.length;e++){var f=b[e];if(!f._timed)if(this.config.all_timed==
"short"&&!m(f))b.splice(e--,1);else{var c=this._lame_copy({},f);c.start_date=new Date(c.start_date);if(h(f)){if(c.end_date=j(c.start_date),this.config.last_hour!=24)c.end_date=k(c.start_date,this.config.last_hour)}else c.end_date=new Date(f.end_date);var i=!1;c.start_date<this._max_date&&c.end_date>this._min_date&&c.start_date<c.end_date&&(b[e]=c,i=!0);var d=this._lame_copy({},f);d.end_date=new Date(d.end_date);d.start_date=d.start_date<this._min_date?k(this._min_date,this.config.first_hour):k(j(f.start_date),
this.config.first_hour);d.start_date<this._max_date&&d.start_date<d.end_date&&(i?b.splice(e+1,0,d):b[e--]=d)}}var l=this._drag_mode=="move"?!1:g;return n.call(this,b,l)};var i=a.get_visible_events;a.get_visible_events=function(a){return!this.config.all_timed||!this.config.multi_day?i.call(this,a):i.call(this,!1)};a.attachEvent("onBeforeViewChange",function(b,g,h){a._allow_dnd=h=="day"||h=="week";return!0});a._is_main_area_event=function(a){return!(!a._timed&&!(this.config.all_timed===!0||this.config.all_timed==
"short"&&m(a)))};var l=a.updateEvent;a.updateEvent=function(b){var g=a.config.all_timed&&!(a.isOneDayEvent(a._events[b])||a.getState().drag_id);if(g){var h=a.config.update_render;a.config.update_render=!0}l.apply(a,arguments);if(g)a.config.update_render=h}})()});
